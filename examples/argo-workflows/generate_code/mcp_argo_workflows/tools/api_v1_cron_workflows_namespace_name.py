# Copyright 2025 CNOE
# SPDX-License-Identifier: Apache-2.0
# Generated by CNOE OpenAPI MCP Codegen tool

"""Tools for /api/v1/cron-workflows/{namespace}/{name} operations"""

import logging
from typing import Dict, Any, List
from mcp_argo_workflows.api.client import make_api_request, assemble_nested_body

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("mcp_tools")


async def get_cron_wf_svc_get_cron_wf(path_namespace: str, path_name: str, param_get_options_resource_version: str = None) -> Any:
  """


      OpenAPI Description:


      Args:

          path_namespace (str): OpenAPI parameter corresponding to 'path_namespace'

          path_name (str): OpenAPI parameter corresponding to 'path_name'

          param_get_options_resource_version (str): resourceVersion sets a constraint on what resource versions a request may be served from.
  See https://kubernetes.io/docs/reference/using-api/api-concepts/#resource-versions for
  details.

  Defaults to unset
  +optional


      Returns:
          Any: The JSON response from the API call.

      Raises:
          Exception: If the API request fails or returns an error.
  """
  logger.debug("Making GET request to /api/v1/cron-workflows/{namespace}/{name}")

  params = {}
  data = {}

  if param_get_options_resource_version is not None:
    params["get_options_resource_version"] = (
      str(param_get_options_resource_version).lower()
      if isinstance(param_get_options_resource_version, bool)
      else param_get_options_resource_version
    )

  flat_body = {}
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(f"/api/v1/cron-workflows/{path_namespace}/{path_name}", method="GET", params=params, data=data)

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response


async def put_cron_wf_svc_upd_cron_wf(
  path_namespace: str,
  path_name: str,
  body_cron_workflow_api_version: str = None,
  body_cron_workflow_kind: str = None,
  body_cron_workflow_metadata: Dict[str, Any] = None,
  body_cron_workflow_spec: Dict[str, Any] = None,
  body_cron_workflow_status_active: List[Dict[str, Any]] = None,
  body_cron_workflow_status_conditions: List[Dict[str, Any]] = None,
  body_cron_workflow_status_failed: int = None,
  body_cron_workflow_status_last_scheduled_time: str = None,
  body_cron_workflow_status_phase: str = None,
  body_cron_workflow_status_succeeded: int = None,
  body_name: str = None,
  body_namespace: str = None,
) -> Any:
  """


  OpenAPI Description:


  Args:

      path_namespace (str): OpenAPI parameter corresponding to 'path_namespace'

      path_name (str): DEPRECATED: This field is ignored.

      body_cron_workflow_api_version (str): APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.io.k8s.community/contributors/devel/sig-architecture/api-conventions.md#resources

      body_cron_workflow_kind (str): Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.io.k8s.community/contributors/devel/sig-architecture/api-conventions.md#types-kinds

      body_cron_workflow_metadata (Dict[str, Any]): ObjectMeta is metadata that all persisted resources must have, which includes all objects users must create.

      body_cron_workflow_spec (Dict[str, Any]): CronWorkflowSpec is the specification of a CronWorkflow

      body_cron_workflow_status_active (List[Dict[str, Any]]): Active is a list of active workflows stemming from this CronWorkflow

      body_cron_workflow_status_conditions (List[Dict[str, Any]]): Conditions is a list of conditions the CronWorkflow may have

      body_cron_workflow_status_failed (int): v3.6 and after: Failed counts how many times child workflows failed

      body_cron_workflow_status_last_scheduled_time (str): Time is a wrapper around time.Time which supports correct marshaling to YAML and JSON.  Wrappers are provided for many of the factory methods that the time package offers.

      body_cron_workflow_status_phase (str): v3.6 and after: Phase is an enum of Active or Stopped. It changes to Stopped when stopStrategy.expression is true

      body_cron_workflow_status_succeeded (int): v3.6 and after: Succeeded counts how many times child workflows succeeded

      body_name (str): DEPRECATED: This field is ignored.

      body_namespace (str): OpenAPI parameter corresponding to 'body_namespace'


  Returns:
      Any: The JSON response from the API call.

  Raises:
      Exception: If the API request fails or returns an error.
  """
  logger.debug("Making PUT request to /api/v1/cron-workflows/{namespace}/{name}")

  params = {}
  data = {}

  flat_body = {}
  if body_cron_workflow_api_version is not None:
    flat_body["cron_workflow_api_version"] = body_cron_workflow_api_version
  if body_cron_workflow_kind is not None:
    flat_body["cron_workflow_kind"] = body_cron_workflow_kind
  if body_cron_workflow_metadata is not None:
    flat_body["cron_workflow_metadata"] = body_cron_workflow_metadata
  if body_cron_workflow_spec is not None:
    flat_body["cron_workflow_spec"] = body_cron_workflow_spec
  if body_cron_workflow_status_active is not None:
    flat_body["cron_workflow_status_active"] = body_cron_workflow_status_active
  if body_cron_workflow_status_conditions is not None:
    flat_body["cron_workflow_status_conditions"] = body_cron_workflow_status_conditions
  if body_cron_workflow_status_failed is not None:
    flat_body["cron_workflow_status_failed"] = body_cron_workflow_status_failed
  if body_cron_workflow_status_last_scheduled_time is not None:
    flat_body["cron_workflow_status_last_scheduled_time"] = body_cron_workflow_status_last_scheduled_time
  if body_cron_workflow_status_phase is not None:
    flat_body["cron_workflow_status_phase"] = body_cron_workflow_status_phase
  if body_cron_workflow_status_succeeded is not None:
    flat_body["cron_workflow_status_succeeded"] = body_cron_workflow_status_succeeded
  if body_name is not None:
    flat_body["name"] = body_name
  if body_namespace is not None:
    flat_body["namespace"] = body_namespace
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(f"/api/v1/cron-workflows/{path_namespace}/{path_name}", method="PUT", params=params, data=data)

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response


async def del_cron_wf_svc_del_cron_wf(
  path_namespace: str,
  path_name: str,
  param_delete_options_grace_period_seconds: str = None,
  param_delete_options_preconditions_uid: str = None,
  param_delete_options_preconditions_resource_version: str = None,
  param_delete_options_orphan_dependents: bool = False,
  param_delete_options_propagation_policy: str = None,
  param_delete_options_dry_run: List[str] = None,
  param_delete_options_ignore_store_read_error_with_cluster_breaking_potential: bool = False,
) -> Any:
  """


      OpenAPI Description:


      Args:

          path_namespace (str): OpenAPI parameter corresponding to 'path_namespace'

          path_name (str): OpenAPI parameter corresponding to 'path_name'

          param_delete_options_grace_period_seconds (str): The duration in seconds before the object should be deleted. Value must be non-negative integer.
  The value zero indicates delete immediately. If this value is nil, the default grace period for the
  specified type will be used.
  Defaults to a per object value if not specified. zero means delete immediately.
  +optional.

          param_delete_options_preconditions_uid (str): Specifies the target UID.
  +optional.

          param_delete_options_preconditions_resource_version (str): Specifies the target ResourceVersion
  +optional.

          param_delete_options_orphan_dependents (bool): Deprecated: please use the PropagationPolicy, this field will be deprecated in 1.7.
  Should the dependent objects be orphaned. If true/false, the "orphan"
  finalizer will be added to/removed from the object's finalizers list.
  Either this field or PropagationPolicy may be set, but not both.
  +optional.

          param_delete_options_propagation_policy (str): Whether and how garbage collection will be performed.
  Either this field or OrphanDependents may be set, but not both.
  The default policy is decided by the existing finalizer set in the
  metadata.finalizers and the resource-specific default policy.
  Acceptable values are: 'Orphan' - orphan the dependents; 'Background' -
  allow the garbage collector to delete the dependents in the background;
  'Foreground' - a cascading policy that deletes all dependents in the
  foreground.
  +optional.

          param_delete_options_dry_run (List[str]): When present, indicates that modifications should not be
  persisted. An invalid or unrecognized dryRun directive will
  result in an error response and no further processing of the
  request. Valid values are:
  - All: all dry run stages will be processed
  +optional
  +listType=atomic.

          param_delete_options_ignore_store_read_error_with_cluster_breaking_potential (bool): if set to true, it will trigger an unsafe deletion of the resource in
  case the normal deletion flow fails with a corrupt object error.
  A resource is considered corrupt if it can not be retrieved from
  the underlying storage successfully because of a) its data can
  not be transformed e.g. decryption failure, or b) it fails
  to decode into an object.
  NOTE: unsafe deletion ignores finalizer constraints, skips
  precondition checks, and removes the object from the storage.
  WARNING: This may potentially break the cluster if the workload
  associated with the resource being unsafe-deleted relies on normal
  deletion flow. Use only if you REALLY know what you are doing.
  The default value is false, and the user must opt in to enable it
  +optional.


      Returns:
          Any: The JSON response from the API call.

      Raises:
          Exception: If the API request fails or returns an error.
  """
  logger.debug("Making DELETE request to /api/v1/cron-workflows/{namespace}/{name}")

  params = {}
  data = {}

  if param_delete_options_grace_period_seconds is not None:
    params["delete_options_grace_period_seconds"] = (
      str(param_delete_options_grace_period_seconds).lower()
      if isinstance(param_delete_options_grace_period_seconds, bool)
      else param_delete_options_grace_period_seconds
    )

  if param_delete_options_preconditions_uid is not None:
    params["delete_options_preconditions_uid"] = (
      str(param_delete_options_preconditions_uid).lower()
      if isinstance(param_delete_options_preconditions_uid, bool)
      else param_delete_options_preconditions_uid
    )

  if param_delete_options_preconditions_resource_version is not None:
    params["delete_options_preconditions_resource_version"] = (
      str(param_delete_options_preconditions_resource_version).lower()
      if isinstance(param_delete_options_preconditions_resource_version, bool)
      else param_delete_options_preconditions_resource_version
    )

  if param_delete_options_orphan_dependents is not None:
    params["delete_options_orphan_dependents"] = (
      str(param_delete_options_orphan_dependents).lower()
      if isinstance(param_delete_options_orphan_dependents, bool)
      else param_delete_options_orphan_dependents
    )

  if param_delete_options_propagation_policy is not None:
    params["delete_options_propagation_policy"] = (
      str(param_delete_options_propagation_policy).lower()
      if isinstance(param_delete_options_propagation_policy, bool)
      else param_delete_options_propagation_policy
    )

  if param_delete_options_dry_run is not None:
    params["delete_options_dry_run"] = (
      str(param_delete_options_dry_run).lower() if isinstance(param_delete_options_dry_run, bool) else param_delete_options_dry_run
    )

  if param_delete_options_ignore_store_read_error_with_cluster_breaking_potential is not None:
    params["delete_options_ignore_store_read_error_with_cluster_breaking_potential"] = (
      str(param_delete_options_ignore_store_read_error_with_cluster_breaking_potential).lower()
      if isinstance(param_delete_options_ignore_store_read_error_with_cluster_breaking_potential, bool)
      else param_delete_options_ignore_store_read_error_with_cluster_breaking_potential
    )

  flat_body = {}
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(
    f"/api/v1/cron-workflows/{path_namespace}/{path_name}", method="DELETE", params=params, data=data
  )

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response
