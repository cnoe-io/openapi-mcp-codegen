# Copyright 2025 CNOE
# SPDX-License-Identifier: Apache-2.0
# Generated by CNOE OpenAPI MCP Codegen tool

"""Tools for /api/v1/events/{namespace}/{discriminator} operations"""

import logging
from typing import Any
from mcp_argo_workflows.api.client import make_api_request, assemble_nested_body

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("mcp_tools")


async def post_event_svc_receive_event(path_namespace: str, path_discriminator: str, body: str) -> Any:
  """


      OpenAPI Description:


      Args:

          path_namespace (str): The namespace for the io.argoproj.workflow.v1alpha1. This can be empty if the client has cluster scoped permissions.
  If empty, then the event is "broadcast" to workflow event binding in all namespaces.

          path_discriminator (str): Optional discriminator for the io.argoproj.workflow.v1alpha1. This should almost always be empty.
  Used for edge-cases where the event payload alone is not provide enough information to discriminate the event.
  This MUST NOT be used as security mechanism, e.g. to allow two clients to use the same access token, or
  to support webhooks on unsecured server. Instead, use access tokens.
  This is made available as `discriminator` in the event binding selector (`/spec/event/selector)`

          body (str): Item expands a single workflow step into multiple parallel steps The value of Item can be a map, string, bool, or number


      Returns:
          Any: The JSON response from the API call.

      Raises:
          Exception: If the API request fails or returns an error.
  """
  logger.debug("Making POST request to /api/v1/events/{namespace}/{discriminator}")

  params = {}
  data = {}

  flat_body = {}
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(
    f"/api/v1/events/{path_namespace}/{path_discriminator}", method="POST", params=params, data=data
  )

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response
