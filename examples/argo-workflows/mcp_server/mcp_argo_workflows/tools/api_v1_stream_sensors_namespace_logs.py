# Copyright 2025 CNOE
# SPDX-License-Identifier: Apache-2.0
# Generated by CNOE OpenAPI MCP Codegen tool

"""Tools for /api/v1/stream/sensors/{namespace}/logs operations"""

import logging
from typing import Any
from mcp_argo_workflows.api.client import make_api_request, assemble_nested_body

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("mcp_tools")


async def sensor_service_sensors_logs(
    path_namespace: str,
    param_name: str = None,
    param_triggerName: str = None,
    param_grep: str = None,
    param_podLogOptions_container: str = None,
    param_podLogOptions_follow: bool = False,
    param_podLogOptions_previous: bool = False,
    param_podLogOptions_sinceSeconds: str = None,
    param_podLogOptions_sinceTime_seconds: str = None,
    param_podLogOptions_sinceTime_nanos: int = None,
    param_podLogOptions_timestamps: bool = False,
    param_podLogOptions_tailLines: str = None,
    param_podLogOptions_limitBytes: str = None,
    param_podLogOptions_insecureSkipTLSVerifyBackend: bool = False,
    param_podLogOptions_stream: str = None,
) -> Any:
    """
    Retrieve details of a specific logs

    OpenAPI Description:
        Retrieve details of a specific logs Use when: for debugging issues or understanding resource behavior. Required: namespace

    Args:

        path_namespace (str): Kubernetes namespace to scope the operation

        param_name (str): optional - only return entries for this sensor name.

        param_triggerName (str): optional - only return entries for this trigger.

        param_grep (str): option - only return entries where `msg` contains this regular expressions.

        param_podLogOptions_container (str): The container for which to stream logs. Defaults to only container if there is o...

        param_podLogOptions_follow (bool): Follow the log stream of the pod. Defaults to false. +optional.

        param_podLogOptions_previous (bool): Return previous terminated container logs. Defaults to false. +optional.

        param_podLogOptions_sinceSeconds (str): A relative time in seconds before the current time from which to show logs. If t...

        param_podLogOptions_sinceTime_seconds (str): Represents seconds of UTC time since Unix epoch 1970-01-01T00:00:00Z. Must be fr...

        param_podLogOptions_sinceTime_nanos (int): Non-negative fractions of a second at nanosecond resolution. Negative second val...

        param_podLogOptions_timestamps (bool): If true, add an RFC3339 or RFC3339Nano timestamp at the beginning of every line ...

        param_podLogOptions_tailLines (str): If set, the number of lines from the end of the logs to show. If not specified, ...

        param_podLogOptions_limitBytes (str): If set, the number of bytes to read from the server before terminating the log o...

        param_podLogOptions_insecureSkipTLSVerifyBackend (bool): insecureSkipTLSVerifyBackend indicates that the apiserver should not confirm the...

        param_podLogOptions_stream (str): Specify which container log stream to return to the client. Acceptable values ar...


    Returns:
        Any: The JSON response from the API call.

    Raises:
        Exception: If the API request fails or returns an error.
    """
    logger.debug("Making GET request to /api/v1/stream/sensors/{namespace}/logs")

    params = {}
    data = {}

    if param_name is not None:
        params["name"] = str(param_name).lower() if isinstance(param_name, bool) else param_name

    if param_triggerName is not None:
        params["triggerName"] = str(param_triggerName).lower() if isinstance(param_triggerName, bool) else param_triggerName

    if param_grep is not None:
        params["grep"] = str(param_grep).lower() if isinstance(param_grep, bool) else param_grep

    if param_podLogOptions_container is not None:
        params["podLogOptions_container"] = (
            str(param_podLogOptions_container).lower() if isinstance(param_podLogOptions_container, bool) else param_podLogOptions_container
        )

    if param_podLogOptions_follow is not None:
        params["podLogOptions_follow"] = (
            str(param_podLogOptions_follow).lower() if isinstance(param_podLogOptions_follow, bool) else param_podLogOptions_follow
        )

    if param_podLogOptions_previous is not None:
        params["podLogOptions_previous"] = (
            str(param_podLogOptions_previous).lower() if isinstance(param_podLogOptions_previous, bool) else param_podLogOptions_previous
        )

    if param_podLogOptions_sinceSeconds is not None:
        params["podLogOptions_sinceSeconds"] = (
            str(param_podLogOptions_sinceSeconds).lower()
            if isinstance(param_podLogOptions_sinceSeconds, bool)
            else param_podLogOptions_sinceSeconds
        )

    if param_podLogOptions_sinceTime_seconds is not None:
        params["podLogOptions_sinceTime_seconds"] = (
            str(param_podLogOptions_sinceTime_seconds).lower()
            if isinstance(param_podLogOptions_sinceTime_seconds, bool)
            else param_podLogOptions_sinceTime_seconds
        )

    if param_podLogOptions_sinceTime_nanos is not None:
        params["podLogOptions_sinceTime_nanos"] = (
            str(param_podLogOptions_sinceTime_nanos).lower()
            if isinstance(param_podLogOptions_sinceTime_nanos, bool)
            else param_podLogOptions_sinceTime_nanos
        )

    if param_podLogOptions_timestamps is not None:
        params["podLogOptions_timestamps"] = (
            str(param_podLogOptions_timestamps).lower()
            if isinstance(param_podLogOptions_timestamps, bool)
            else param_podLogOptions_timestamps
        )

    if param_podLogOptions_tailLines is not None:
        params["podLogOptions_tailLines"] = (
            str(param_podLogOptions_tailLines).lower() if isinstance(param_podLogOptions_tailLines, bool) else param_podLogOptions_tailLines
        )

    if param_podLogOptions_limitBytes is not None:
        params["podLogOptions_limitBytes"] = (
            str(param_podLogOptions_limitBytes).lower()
            if isinstance(param_podLogOptions_limitBytes, bool)
            else param_podLogOptions_limitBytes
        )

    if param_podLogOptions_insecureSkipTLSVerifyBackend is not None:
        params["podLogOptions_insecureSkipTLSVerifyBackend"] = (
            str(param_podLogOptions_insecureSkipTLSVerifyBackend).lower()
            if isinstance(param_podLogOptions_insecureSkipTLSVerifyBackend, bool)
            else param_podLogOptions_insecureSkipTLSVerifyBackend
        )

    if param_podLogOptions_stream is not None:
        params["podLogOptions_stream"] = (
            str(param_podLogOptions_stream).lower() if isinstance(param_podLogOptions_stream, bool) else param_podLogOptions_stream
        )

    flat_body = {}
    data = assemble_nested_body(flat_body)

    success, response = await make_api_request(f"/api/v1/stream/sensors/{path_namespace}/logs", method="GET", params=params, data=data)

    if not success:
        logger.error(f"Request failed: {response.get('error')}")
        return {"error": response.get("error", "Request failed")}
    return response
