# Copyright 2025 CNOE
# SPDX-License-Identifier: Apache-2.0
# Generated by CNOE OpenAPI MCP Codegen tool

"""Tools for /api/v1/cron-workflows/{namespace}/{name} operations"""

import logging
from typing import Any
from mcp_argo_workflows.api.client import make_api_request, assemble_nested_body

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("mcp_tools")


async def cron_workflow_service_get_cron_workflow(path_namespace: str, path_name: str, param_getOptions_resourceVersion: str = None) -> Any:
  """
  Retrieve cron-workflows information

  OpenAPI Description:
      Retrieves details of a specific cron workflow. Use when: checking current configuration or investigating issues with scheduled tasks.

  Args:

      path_namespace (str): "Kubernetes namespace to locate the cron workflow"

      path_name (str): Specifies the cron workflow to retrieve in the given namespace.

      param_getOptions_resourceVersion (str): Specify resource version to retrieve specific state (optional)


  Returns:
      Any: The JSON response from the API call.

  Raises:
      Exception: If the API request fails or returns an error.
  """
  logger.debug("Making GET request to /api/v1/cron-workflows/{namespace}/{name}")

  params = {}
  data = {}

  if param_getOptions_resourceVersion is not None:
    params["getOptions_resourceVersion"] = (
      str(param_getOptions_resourceVersion).lower()
      if isinstance(param_getOptions_resourceVersion, bool)
      else param_getOptions_resourceVersion
    )

  flat_body = {}
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(f"/api/v1/cron-workflows/{path_namespace}/{path_name}", method="GET", params=params, data=data)

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response


async def cron_workflow_service_update_cron_workflow(path_namespace: str, path_name: str) -> Any:
  """
  Update or replace a cron-workflows

  OpenAPI Description:
      Updates cron workflow configuration. Use when: modifying schedule or settings of an existing cron workflow.

  Args:

      path_namespace (str): "Kubernetes namespace to target for the cron workflow operation"

      path_name (str): Unique name of the cron workflow to update


  Returns:
      Any: The JSON response from the API call.

  Raises:
      Exception: If the API request fails or returns an error.
  """
  logger.debug("Making PUT request to /api/v1/cron-workflows/{namespace}/{name}")

  params = {}
  data = {}

  flat_body = {}
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(f"/api/v1/cron-workflows/{path_namespace}/{path_name}", method="PUT", params=params, data=data)

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response


async def cron_workflow_service_delete_cron_workflow(
  path_namespace: str,
  path_name: str,
  param_deleteOptions_gracePeriodSeconds: int = None,
  param_deleteOptions_preconditions_uid: str = None,
  param_deleteOptions_preconditions_resourceVersion: str = None,
  param_deleteOptions_orphanDependents: bool = False,
  param_deleteOptions_propagationPolicy: str = None,
  param_deleteOptions_dryRun: str = None,
  param_deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential: str = None,
) -> Any:
  """
  Delete a cron-workflows

  OpenAPI Description:
      Deletes a cron workflow by name and namespace. Use when: removing outdated or unnecessary scheduled tasks to free up resources.

  Args:

      path_namespace (str): "Kubernetes namespace of the cron workflow to delete"

      path_name (str): Specifies the cron workflow to delete within the namespace.

      param_deleteOptions_gracePeriodSeconds (int): Specifies delay in seconds before deletion; use for graceful shutdown.

      param_deleteOptions_preconditions_uid (str): "UID to ensure deletion only if it matches the target resource"

      param_deleteOptions_preconditions_resourceVersion (str): "Ensure deletion only if resource version matches specified value"

      param_deleteOptions_orphanDependents (bool): Control orphan resource deletion; use PropagationPolicy instead.

      param_deleteOptions_propagationPolicy (str): Specifies garbage collection method (e.g., "Foreground", "Background")

      param_deleteOptions_dryRun (str): Simulate deletion without saving changes (e.g., ["All"]).

      param_deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential (str): Ignore store read errors for unsafe deletion when true


  Returns:
      Any: The JSON response from the API call.

  Raises:
      Exception: If the API request fails or returns an error.
  """
  logger.debug("Making DELETE request to /api/v1/cron-workflows/{namespace}/{name}")

  params = {}
  data = {}

  if param_deleteOptions_gracePeriodSeconds is not None:
    params["deleteOptions_gracePeriodSeconds"] = (
      str(param_deleteOptions_gracePeriodSeconds).lower()
      if isinstance(param_deleteOptions_gracePeriodSeconds, bool)
      else param_deleteOptions_gracePeriodSeconds
    )

  if param_deleteOptions_preconditions_uid is not None:
    params["deleteOptions_preconditions_uid"] = (
      str(param_deleteOptions_preconditions_uid).lower()
      if isinstance(param_deleteOptions_preconditions_uid, bool)
      else param_deleteOptions_preconditions_uid
    )

  if param_deleteOptions_preconditions_resourceVersion is not None:
    params["deleteOptions_preconditions_resourceVersion"] = (
      str(param_deleteOptions_preconditions_resourceVersion).lower()
      if isinstance(param_deleteOptions_preconditions_resourceVersion, bool)
      else param_deleteOptions_preconditions_resourceVersion
    )

  if param_deleteOptions_orphanDependents is not None:
    params["deleteOptions_orphanDependents"] = (
      str(param_deleteOptions_orphanDependents).lower()
      if isinstance(param_deleteOptions_orphanDependents, bool)
      else param_deleteOptions_orphanDependents
    )

  if param_deleteOptions_propagationPolicy is not None:
    params["deleteOptions_propagationPolicy"] = (
      str(param_deleteOptions_propagationPolicy).lower()
      if isinstance(param_deleteOptions_propagationPolicy, bool)
      else param_deleteOptions_propagationPolicy
    )

  if param_deleteOptions_dryRun is not None:
    params["deleteOptions_dryRun"] = (
      str(param_deleteOptions_dryRun).lower() if isinstance(param_deleteOptions_dryRun, bool) else param_deleteOptions_dryRun
    )

  if param_deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential is not None:
    params["deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential"] = (
      str(param_deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential).lower()
      if isinstance(param_deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential, bool)
      else param_deleteOptions_ignoreStoreReadErrorWithClusterBreakingPotential
    )

  flat_body = {}
  data = assemble_nested_body(flat_body)

  success, response = await make_api_request(
    f"/api/v1/cron-workflows/{path_namespace}/{path_name}", method="DELETE", params=params, data=data
  )

  if not success:
    logger.error(f"Request failed: {response.get('error')}")
    return {"error": response.get("error", "Request failed")}
  return response
